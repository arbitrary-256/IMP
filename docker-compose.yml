# 1) create and populate a .env file made from template.env
# 2) point your desired firewall ports at your docker host:
## ${IMPFRONTENDPORT} exposes the front end web client to the internet
## ${IMPEXTERNALPORT} exposes the backend database to the internet
# 3) run 'yarn imp-compose' to deploy webapp and database with docker compose
version: '3.8'
services:
# nginx web server to host the web application
 webapp:
  image: nginx:${IMPNGINXVERSION}
  volumes:
   - ${PWD}/build:/usr/share/nginx/html
  ports:
   - "${IMPFRONTENDPORT}:80"

# MariaDB database to host the backend data
 database:
  image: mariadb:${IMPMARIADBVERSION}
  volumes:
   - ${PWD}/mariadbdata:/var/lib/mysql
  environment:
   - MYSQL_ROOT_USER="${IMPROOTUSERNAME}"
   - MYSQL_ROOT_PASSWORD="${IMPROOTPASSWORD}"
   - MYSQL_USER="${IMPUSERNAME}"
   - MYSQL_PASSWORD="${IMPPASSWORD}"
   - MYSQL_DATABASE="${IMPDATABASE}"
  ports:
   - '${IMPEXTERNALPORT}:${IMPCONTAINERPORT}'
  networks:
   - impnet
networks:
 impnet:
  external: false
